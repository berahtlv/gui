#:kivy 1.0

# workaround: Template can't use ids
#:set sidebar_width 60
#:set sidebar_padding 5

# color of application window
#:set colortheme (0.2, 0.2, 0.2)


MainWindow:

<MainWindow>:
    orientation: 'vertical'

    Menubar:
        id: menubar
        orientation: 'horizontal'
        size_hint: 1, None
        height: 30

        canvas.before:
            Color:
                rgb: colortheme
            Rectangle:
                pos: self.pos
                size: self.size

        Label:
            size_hint: None, 1
            width: 50
            text: 'File'

        Label:
            size_hint: None, 1
            width: 50
            text: 'View'

    Toolbar:
        id: toolbar
        orientation: 'horizontal'
        size_hint: 1, None
        height: 30

        canvas.before:
            Color:
                rgb: colortheme
            Rectangle:
                pos: self.pos
                size: self.size

        Button:
            size_hint: None, 1
            width: 50
            text: 'Func1'

        Button:
            size_hint: None, 1
            width: 50
            text: 'Func2'

    BoxLayout:
        orientation: 'horizontal'

        Sidebar:
            id: sidebar
            orientation: 'vertical'
            size_hint: None, 1
            padding: sidebar_padding
            spacing: sidebar_padding
            width: sidebar_width

            canvas.before:
                Color:
                    rgb: colortheme
                Rectangle:
                    pos: self.pos
                    size: self.size

            # Here are SidebarIcon objects

        ScrollView:
            id: toposcroll
            effect_cls: 'ScrollEffect'
            bar_margin: 1
            bar_width: 7
            scroll_type: ['content']

            TopologyMap:
                id: topomap
                size_hint: None, None
                size: 1500, 900

                canvas.before:
                    Color:
                        rgb: 1, 1, 1
                    Rectangle:
                        pos: 0, 0
                        size: self.size

                # Here are TopomapIcon and TopomapConnect objects

    Statusbar:
        id: statusbar
        orientation: 'horizontal'
        size_hint: 1, None
        height: 20

        canvas.before:
            Color:
                rgb: colortheme
            Rectangle:
                pos: self.pos
                size: self.size

        Label:
            text: 'Some state'

<SidebarIcon>:
    group: 'elements'
    allow_strech: True
    size_hint: None, None
    height: sidebar_width - 2 * sidebar_padding
    width: sidebar_width - 2 * sidebar_padding

<TopomapIcon>:
    id: topoicon
    allow_strech: True
    size_hint: None, None
    height: 50
    width: 50
    drag_rectangle: self.x, self.y, self.width, self.height
    drag_timeout: 30000
    drag_distance: 10

    Label:
        size: self.texture_size
        x: topoicon.x
        y: topoicon.y - 20
        color: 0, 0, 0, 1
        font_size: 13
        italic: True
        text: topoicon.el_id

<TopomapConnect>:
    size_hint: None, None

    canvas:
        Color:
            rgba: self.conn_color
        Line:
            width: 3
            points: self.conn_points
